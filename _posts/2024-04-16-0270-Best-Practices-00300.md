---
layout: article
---
Следующий момент это размер. При создании образов старайся, чтобы размер был как можно меньше. Это позволит быстрее извлекать образ из сетевого реджистри, быстрее создавать экземпляры, а также сэкономит рабочеее место на хостах. Рекомендации такие:

- Есть различные образы с минимальными версиями операционных систем, а также distroless images, старайся использовать их в качестве базовых образов.
- При работе с базовыми образами не используй тег `latest`. Старайся указывать тег, точно идентифицирующий эту сборку или используй дайджест.
- Используй кэш (inline, local, directory cache) для ускорения, объединяй команды в RUN-инструкциях через `&&` или `;`, удаляй списки пакетного менеджера и архивы его пакетов после их установки (обрати внимание, что это не одно и тоже).
- Узнай, как именно работает процесс сборки твоих приложений с перспективы кэширования. Например, при работе `npm install` каждый раз формируется файл `package-lock.json`, который может сломать весь механизм кэширования.
- Не устанавливай программное обеспечение `про запас`. Ставь только абсолютно необходимые библиотеки и пакеты, а также удаляй все вспомогательные файлы, сгенерированные в рамках одного слоя сборки.

Помни, если файл был `запечён` в слое, он уже никуда не денется, он навсегда останется в образе, даже если его удалить в следующем слое. Современные пакетные менеджеры имеют механизм `--no-install-recommends` или его аналоги, проверь, что он включен.
