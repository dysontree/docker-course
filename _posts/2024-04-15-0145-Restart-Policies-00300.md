---
layout: article
---
Скажем, у нас здесь веб-приложение, которое случайно выходит из строя. Что мы делаем, если такое произошло? Ну мы должны просмотреть логи, выявить проблему и устранить причину неполадки. Но иногда у нас нет возможности этим заниматься, поскольку у нас есть пользователи, которые в данный момент ожидают обслуживания. Все, что, мы хотим - это чтобы он перезапустился и закрыл образовавшийся разрыв в предоставлении услуги. Потом мы конечно вернемся, проверим логи и выясним, почему произошел этот сбой. Но прямо сейчас нужно сделать так, чтобы в случае сбоя он немедленно перезапустился, поскольку мы не хотим, чтобы это влияло на пользователей.

Чтобы настроить автоматический перезапуск контейнера, мы можем использовать опцию `--restart` с одним из этих вариантов:

- По умолчанию установлено значение `no`, что означает, что контейнеры никогда не перезапускаются автоматикой.
- Следующий `on-failure`. Это перезапускает контейнер только в случае сбоя. То, что произошла авария, определяется по ненулевому коду выхода. Если код выхода равен нулю, это не сбой. Если он отличается от нуля, это авария. В этом случае он автоматически перезапустится.
- Далее `always`, что означает, что контейнер будет перезапускаться всегда, независимо от того, как он завершился: успешно ли, с падением или был остановлен вручную.
Тут маленький момент. Если остановили вручную, он не перезапускает контейнер сразу после остановки. Перезапуск будет только при перезапуске демона dockerd. Так что имей это в виду. В реальной ситуации, если администратор запустил команду `docker container stop`, то он сделал это по уважительной причине. Именно поэтому у этого механизма такая особенность.
- Последний вариант — это параметр `unless-stopped`. Он который работает так же, как и `always`, т.е. перезапускает контейнер, когда тот упал или завершился, но не перезапускает, если он был остановлен вручную при помощи команды `container stop`, даже в случае перезапуска демона.
