---
layout: article
---
Для создания образа в простейшем виде нам понадобится исполняемый файл, который сможет делать вызовы к ядру. Для примера, я разместил простую программу в репо курса:

```
git clone https://github.com/rotoro-cloud/docker-advanced.git
cd docker-advanced/hello-world/
```

Взгляни на Dockerfile. Здесь мы собираем простейший образ, содержащий программу написанную на языке `C`, которая выводит текстовое сообщение. Код программы также есть в репо.

```
FROM scratch
COPY custom-program /
CMD ["/custom-program"]
```

```
docker  image  build  -t  hello  .
```

Теперь запустим:

```
docker  container  run  hello
```

Но в реальном мире не бывает, чтобы программа работала в одиночку. Это потому, что программы пишут с упором на какие-то библиотеки и инструменты, которые она будет использовать в своей работе. И для правильного функционирования нам придется положить их в образ рядом с нашей программой. Для примера в этом же репо я создал образ, который делает тоже самое, т.е. выводит сообщение, но делает это посредством утилит ОС Linux Alpine.

```
cd docker-advanced/alpine/
```

Вот его Dockerfie. Он также начинается `FROM scratch`, но следующей инструкцией мы заливаем туда структуру каталогов операционной системы, а далее копируем туда файл со своим сообщением. При запуске контейнера по умолчанию будет вызвана утилита `cat`, которая выведет на экран наш файл `hello.txt`. 

```
FROM scratch
ADD rootfs.tar.gz /
ADD hello.txt /
CMD ["cat", "hello.txt"]
```

Соберем и запустим:

```
docker  image  build  -t  alpine  .
```

```
docker  container  run  alpine
```

Таким образом, чтобы воспользоваться утилитой `cat`, мы положили в контейнер крошечную ОС. Файлы этой операционной системы были в tar-архиве, и мы скопировали этот файл `rootfs.tar` внутрь образа. Именно так создаются популярные версии операционных систем в контейнерах. Точнее их базовые образы.

Наш файл с ОС размером чуть больше 3мб. Но для более серьезных проектов нам не хватит его функциональности. Мы можем самостоятельно дополнить его, скопировав или загрузив в образ дополнительные библиотеки. Но это дело непростое и хлопотное, поскольку нам придется соблюсти все зависимости. Иногда нам проще использовать то, что уже сделали за нас производители базовых образов. Но не всегда. Если у нас строгие требования по безопасности или жесткие стандарты комплаенса, эту утомительную работу по сборке и обновлению образов `с нуля` придется делать самим.

И это всё, увидимся.
