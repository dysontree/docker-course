---
layout: article
---

Мы подошли к секции про безопасность.

- Если тебе нужно что-то скачать из сети, а для доступа нам часто нужен токен или пароль, нельзя его писать в Dockerfile, поскольку в команде `image history` все это будет в открытом виде. Если тебе никак без этого не обойтись - используй переданные секреты сборки (`--secret`). Если использовал `--build-arg`, то и убедись, что их не видно в истории образа. Т.е. поверь себя через `image history`
- Тоже самое с токенами в виде файлов. Если ты скопировал файл через COPY/ADD, то эти чувствительные данные так и останутся в слое. В качестве альтернативы используй монтирования на время сборки или локальный http-сервер, через который можно передать эти креденшилс.

BuildKit позволяет производить монтирования во время сборки, которые не являются частью образов и передавать `secrets`. Это хорошие варианты для доставки секретов. Мы увидим это в темах про хранение.

- Далее - это git и всё, что с ним связано. git помнит все, даже если кто-то по ошибке туда что-то добавил, а потом затёр. Поэтому попадание истории репозитория в образ - это очень плохо.
- Напоследок момент, о котором мы поговорим в конце курса, но здесь я задену его вскользь. Это с какими привилегиями и ограничениями запускается процесс в контейнере, кто его пользователь и требуется ли работать в rootless-режиме.

Это не только про технику, но и про политику безопасности, принятую в компании, насколько нам придётся ей соответствовать.

И это всё про построение хороших образов. Увидимся!
