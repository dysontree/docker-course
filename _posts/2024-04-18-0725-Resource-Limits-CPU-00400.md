---
layout: article
---

Какой механизм отвечает за управление ресурсами процессора и распределение времени CPU между разными процессами? 

Он называется планировщиком процессов. Планировщиком по умолчанию в системах Linux является Completely Fair Scheduler (CFS). В Linux есть и другие виды schedulers, например, `idle`, `deadline`, `realtime`. Docker может работать с CFS и с Realtime Scheduler. CFS является планировщиком общего назначения, и далее мы будем говорить о нём.

Поскольку контейнеры являются процессами, для них можно использовать тот же подход. Cgroups позволяют ограничивать ресурсы процессам контейнеров. Если мы установим соотношение 512 к 1024 для двух процессов, то получим разделение процессорного времени примерно `33%` к `66%`. 

Каждому контейнеру по умолчанию назначается доля процессора `1024`. Это означает, что все контейнеры получают одинаковое количество процессорного времени. Чтобы изменить значения доли процессора, мы можем указать параметр `--cpu-shares` при создании контейнера.

```
docker  container  run  -d  --cpu-shares=512  --name  web3  web-image
```

В этом случае третье веб-приложение создается всего с 512 shares, тогда как все остальные по умолчанию получили долю `1024`. Таким образом, первые два контейнера работают на равных, а третий контейнер получит меньшую долю процессора, относительно этих трёх. В процентах это будет по 40% для 1024 и 20% для 512.

Помни, что на объем потребления процессора для контейнеров ограничений не установлено. Мы определили лишь то, как общий CPU хоста будет распределяется между этими контейнерами. Все контейнеры вместе будут потреблять все циклы процессора, т.е. 100% его времени.
