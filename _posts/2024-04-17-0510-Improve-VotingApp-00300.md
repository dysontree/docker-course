---
layout: article
---

Но в начале давай поговорим о дополнительных вещах, которые понадобятся для этого развёртывания. Мы считаем, что мы веб-разработчики, и этот compose нужен нам для локальной работы с приложением.

- Во-первых, мы бы хотели, чтобы у нас было разделение на 3 tiers. И это должно выглядеть также, как организовано на боевом сервере. Пусть это будут подсети с такой же адресацией.

- Во-вторых, поскольку мы разработчики, требуется, чтобы при поднятии стека docker-compose проверял изменения и мог пересобрать образ из Dockerfile.

- В-третьих, для разработки нам потребуются монтирования на хост для служб `vote` и `result`, чтобы мы могли поправить в них код, не перезапуская стек. Также для `redis` и `postgres` мы написали специальные файлы, которые будут проверять их состояние. Поэтому нам нужно сделать хостовое монтирование для этих служб.

- В-четвёртых, для базы нужен постоянный том для хранения данных.

- В-пятых, наши службы должны быть обнесены проверками работоспособности и запускаться в зависимости друг от друга.

- В-шестых, мы должны передать данные для инициализации контейнера базы данных через переменные окружения из файла `.env`.

- В-седьмых, мы написали приложение, которое наполняет базу некоторыми тестовыми данными. Нам бы хотелось бы по желанию наполнять базу, но делать это по явному требованию.

- Напоследок, мы бы хотели сразу иметь 2 реплики приложения для голосования, и конечно на хосте должны быть открыты порты для пользовательских частей приложения.

Вот такие пункты. Они не выдуманы, они реально требуются в разработке приложений с compose. В таком стеке каждый пункт нужен и упрощает жизнь разработчику. Если у тебя что-то из этого не реализовано, подскажи своим разработчикам, они скажут спасибо за эти практики.

Давай рассмотрим инструкции, которые помогут нам реализовать это.
