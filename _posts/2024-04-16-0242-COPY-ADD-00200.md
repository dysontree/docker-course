---
layout: article
---

Обе эти инструкции копируют файлы или каталоги из локальной файловой системы в файловую систему собираемого образа. Однако есть некоторые особенности, которые присутствуют в директиве `ADD`, и которых нет у `COPY`.

Первые два Dockerfiles делают одно и тоже, а именно копируют файл или каталог с исходным кодом. Эти инструкции равнозначны.

```
FROM  	node 
COPY  	app   /appdir/app
```

```
FROM  node
ADD 	app  /appdir/app
```

Во втором случае `ADD` более эффективна, поскольку справляется с работой за одну операцию, а `COPY` требуется две.

```
FROM  node
COPY 	app.tar.gz  /appdir/
RUN 	tar  -xf  /appdir/app.tar.gz  -C  /appdir/
```

```
FROM  node
ADD 	app.tar.gz  /appdir
```

Последний пример показывает, что мы можем добиться такого же результата не прибегая к инструкциям `COPY` или `ADD`. Сейчас здесь три слоя, но этот метод может быть объединён в один слой, и он не будет проигрывать ADD в этой части. Минус в том, что внутри образа нужна утилита вроде `curl`.

```
FROM	node
RUN	  curl  --create-dirs  -o  /appdir/app.tar.gz  https://app.com/app.tar.xz  
RUN 	tar  -xf  /appdir/app.tar.gz  -C  /appdir/
RUN 	rm  -f  /appdir/app.tar.gz 
```

Итак, отличия `ADD` от `COPY`. 
- Во-первых, с помощью директивы `ADD` мы можем указать путь к локальному tar-файлу, и он будет извлечен в образ. Это будет сделано одной командой и займет один слой. В примере выше файл `app.tar.gz` представляет собой сжатый архив, и команда `ADD` извлечет его в каталог `/appdir` внутри образа. Такой архив может быть сжат в `xz` или `bzip2`, это тоже сработает. 
- С помощью инструкции `ADD` мы также можем указать URL-адрес, с которого файл будет скачан и затем размещен внутри образа. Распаковки в этом случае не будет. Кроме удалённых файлов, `ADD` умеет работать с git-репозиториями и проверять контрольные суммы.

Итак, как видишь у `ADD` есть дополнительные функции. Эти функциональные возможности дают `ADD` преимущество перед `COPY`. Обычно здесь студенты спрашивают, какую выбрать? `ADD` или `COPY`? И какие есть лучшие практики в этом отношении?
