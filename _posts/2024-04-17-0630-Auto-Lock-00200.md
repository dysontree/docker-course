---
layout: article
---

Мы можем самостоятельно управлять ключами, которые шифруют RAFT, например, храня их в каком-то внешнем сервисе управления. Далее при работе Docker получает эти ключи и хранит их в памяти, благодаря чему может работать с RAFT logs. После перезагрузки демона, менеджер теряет ключ из оперативной памяти, и для продолжения работы ему требуется снова получить ключ.

Таким образом Docker предоставляет нам дополнительную возможность по защите, чтобы при попытке присоединения к кластеру запрашивалась проверка. Что даёт такая возможность и от чего спасает?

- Допустим, у нас отвалился менеджер, мы создали другой и продолжаем работать. За старым менеджером мы не следили, и к нему кто-то получил доступ. Теперь он может от его имени подключиться к кластеру и расшифровать журналы RAFT.
- Или сняли бекап виртуальной машины, он пролежал какое-то время, и мы не злонамеренно запустили его, вместе с экземпляром менеджера. Он может подключиться к кластеру и не специально поправить какие-то настройки. 

Если мы создали ключ для подключения, то при попытке вернуться обратно в кластер, нам придется предъявить этот ключ, что убережёт нас от таких сюрпризов.

Итак, функция автоблокировки требует у перезапущенных менеджеров предъявить ключ перед допуском в кластер.
