---
layout: article
---

По умолчанию к контейнеру не применяются никакие ограничения, т.е. он может использовать столько памяти, сколько доступно, а также потреблять пространство подкачки. Если приложение внутри контейнера `течёт по памяти` (т.е. постоянно аллоцирует новое пространство, не отпуская старое), мы можем наблюдать периодическую смерть этого или других контейнеров и процессов хоста. Поэтому мы должны подумать и установить ограничения для памяти. 

Чтобы ограничить память контейнера, используй опцию `--memory` при создании контейнера. Можно указать значение в `b` - это для байтов, `k` для килобайтов, `m` для мегабайт и `g` для гигабайт. В моём примере на хосте суммарно `6 ГБ` RAM, каждый желтый прямоугольник по гигабайту.

```
docker  container  run  --memory=512m  --name  web1  web-image
```

Мы установили `512m` что значит, что контейнер может использовать до `512 МБ` оперативной памяти. Это жёсткое ограничение, и этот механизм отличается от ограничений процессора, о котором мы говорили ранее. Отличие в том, что если контейнер потребляет больше памяти, чем указано в этом лимите, он будет уничтожен с исключением `OOM`. 

В случае процессора и его регулировок, контейнеру просто не будут выделены дополнительные такты. Сам контейнер при этом не уничтожается, а просто будет задушен (`throttling`). Но когда контейнер пытается использовать больше памяти, чем ему назначено, у нас нет возможности отрегулировать это. Единственный вариант - контейнер будет уничтожен механизмом OOM-killer.

Итак, установка значения `512m` выделяет для контейнера 512 МБ памяти. Это также позволяет контейнеру использовать такой же объем памяти из swap-пространства. То есть, если контейнер потребляет более 512 МБ, он может использовать еще 512 МБ из пространства подкачки, если это включено на хосте. Суммарно контейнеру доступен `1 Гб`, половина в RAM, половина на диске. Если требуется ограничить пространство подкачки, используем опцию `--memory-swap` при создании контейнера.
