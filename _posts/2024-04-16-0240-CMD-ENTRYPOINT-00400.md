---
layout: article
---

Отличия shell и exec режимов в том, что в первом к процессу дополнительно цепляется оболочка, во втором процесс запускается самостоятельно без неё. Вот пример Dockerfile-1:

```
FROM alpine  
CMD while true; do echo $RANDOM; sleep 1; done
```

```
docker  container  run  test1
```

```
docker  container  top  4f6c  -x
```

Если мы разобьём подобную команду на массив, и попробуем вставить её в `CMD/ENTRYPOINT`, то у нас ничего не выйдет:

```
FROM alpine  
CMD [ "while", "true;", "do", "echo", "$RANDOM;", "sleep", "1;", "done" ]
```

Во-первых, `while`, `$RANDOM` - это вещи, относящиеся к оболочке. Во-вторых, exec-нотация работает иначе. Элементом массива должен быть целый аргумент, который передаётся в вызов. Поправим нашу инструкцию, добавив оболочку и передав туда команду в виде единого аргумента:

```
FROM alpine  
ENTRYPOINT [ "sh", "-c", "while true; do echo $RANDOM; sleep 1; done" ]
```

```
docker  container  run  test2
```

Теперь запустилось. Как видишь внутри оболочки исполняется наша команда.

```
docker  container  top  8244  -x
```

Таким образом, exec-режим считается предпочтительным, но запуская в нём команды нам нужно учитывать его особенности. Например, мы лишаемся переменных оболочки:
