---
layout: article
---

В предыдущих примерах мы предполагали, что все узлы одинаковые по своим техническим характеристиками. Но так бывает не всегда. У нас могут быть более мощные и более слабые узлы. Таким образом, мы бы не хотели размещать громоздкие приложения на слабые узлы.

Скажем, у нас есть приложение с высокой интенсивностью вычислений, и оно требует большого ресурса по `CPU`. Если процессора не будет хватать, приложение будет долго запускаться и сильно тормозить. Второе приложение требует определённого количества памяти и без него откажется стартовать. Третье приложение является обычным, т.е. рядовая рабочая нагрузка. Таких приложений общего назначения обычно большинство.

Итак, в наших кластерах могут быть развёрнуты разные виды рабочей нагрузки. Здесь в качестве примера я выбрал веб-сервер как обычное приложение, обработку видео, как потребляющее много CPU и базу данных, которой требуется много памяти. Также у нас в кластере есть три ноды: одна из них оптимизирована для высоких CPU-вычислений, вторая содержит много памяти, а третья рядовая, без каких-то особенностей.

В данный момент нагрузки будут распределены без учёта наших предпочтений, руководствуясь стандартыми правилами Docker Swarm.

Мы хотим, чтобы службы распределились таким образом, как ты видишь: на более производительные по CPU ноды упали бы контейнеры с высокими требованиями к вычислениям, а на `жирные` по памяти встала бы база данных. Что касается веб-сервера, то пусть поставит его на ноды без особеностей.

Это лишь пример требований. Частые варианты, когда нашим нагрузкам нужны ноды с определённым оборудованием, например с видеокартами или определённой архитектурой процессора, или нам хочется, чтобы на одной ноде рядом исполнялись веб-серверы и кэши оперативной памяти, чтобы уменьшить сетевые задержки. Также часть наших узлов может принадлежать к dev-окружениям, а часть к prod. Территориально они могут находится в разных дата-центрах и даже в разных странах с разным законодательством. Т.е. вариантов может быть масса, условия выбора это не только память и CPU.

По умолчанию, когда мы создаем service, его tasks могут быть назначены любому из этих узлов без каких-либо дополнительных соображений, при условии, что у них есть достаточные аппаратные ресурсы. Таким образом, веб-сервер может оказаться на высокопроизводительном `cpu-opitmized` узле, а обработка видео будет назначена на `memory-opitmized` узел, что плохо скажется на производительности приложения. Требовательная до памяти база попадёт на обычный узел, и в какой-то момент ей может не хватить ресурсов, из-за чего контейнер может стать неисправным.
