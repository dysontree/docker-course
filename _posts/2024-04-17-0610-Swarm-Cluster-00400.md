---
layout: article
---

```
docker  swarm  join  --token  \ SWMTKN-1-2tqvoo8e5r7o7qas1iqb95np61x06f83jz920ey8d3sqb8anp3-f4rzp7ez4dgdyv2mupeejz0gm  172.30.1.2:2377
```

Теперь проверим статус кластера командой `docker node ls`. Это покажет нам список узлов.

```
docker node ls
```

Как видишь, в нем перечислены два узла, они оба готовы и активны. Мы также видим имена хостов и версии Docker Engine на этих узлах.

Статус менеджера – `Leader`. Это значит, что в данный момент дела кластера ведёт именно этот узел.

Теперь давай добавим третий узел. Если вдруг мы потеряли команду на присоединение, мы можем восстановить ее при помощи `docker swarm join-token worker`. Такое часто требуется, когда мы добавляем новую ноду по прошествии какого-то времени. Остаётся только скопировать команду и запустить её на втором рабочем узле.

Снова запустим `docker node ls`. Теперь в кластере уже три узла, два из которых являются воркерами.

Обрати внимание на `*` рядом с именем хоста нашего менеджера. Она подсказывает, что мы обращаемся к кластеру через Docker этой машины. В кластере может быть несколько менеджеров, и каждый из них может получать информацию из кластера или отправлять команды в кластер. Звёздочка показывает, от лица какого менеджера мы общаемся с кластером.

Столбец `AVAILABILITY` указывает статус доступности узла с точки зрения того, можно ли на него назначить нагрузку. Может быть в значениях `Active`, `Pause` и `Drain`. 

- Сейчас это в `Active`, что означает, что нагрузки могут быть назначены на эти узлы. 
- При `Pause` планировщик не назначает новые tasks на узел, но существующие службы продолжают работать как обычно.
- `Drain` опустошает ноду от нагрузок. Т.е. не назначает на узел новые и переносит существующие на другие ноды кластера.

В столбце `MANAGER STATUS` указывается роль узла. Если это рабочая нода, то поле будет пустым. Строка `Leader` указывает, что этот узел является менеджером, и что он сейчас главный в кластере. Такой ведущий узел может быть в кластере только один. Если в этом поле значение `Reachable`, то значит это также менеджер, он в порядке и готов стать лидером, если потребуется. Если менеджер не отвечает, то там будет `Unavailable`.

Как именно swarm-кластер работает с несколькими менеджерами, как выбрать подходящее количество узлов для кластера и какие лучшие практики при этом соблюдать мы обсудим чуть позже в курсе.

Чтобы просмотреть более подробную информацию об узле, запусти команду `docker node inspect`, за которой следует имя узла.

```
docker node inspect ubuntu --pretty
```

Здесь я использовал опцию `--pretty` для вывода в человекочитаемом форматировании. Как ты помнишь, по умолчанию команды `inspect` выводят данные в JSON.

Ну, вот и все. Увидимся!
