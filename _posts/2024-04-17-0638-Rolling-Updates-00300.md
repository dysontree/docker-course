---
layout: article
---

Ок, предположим, что у нас есть три экземпляра нашей службы, приложение работает, и нам потребовалось обновить этот веб-сайт. Мы создали новый образ, он также называется `httpd`, но имеет тег `alpine`. Это новая версия нашего веб-приложения.

Чтобы обновить экземпляры приложения до более новой версии мы запускаем команду `docker service update`, но используя опцию `--image`. В ней мы указываем, что служба должна работать с новым образом.

Команда `service update` пересоздаёт контейнеры с новыми образами один за другим. Это называется `rolling update`. По-русски называют скользящим или плавающим обновлением. С таким подходом мы можем убедиться, что новая версия приложения работает правильно, прежде чем заменим все остальные на всех узлах.

```
docker service update --image=httpd:alpine webserver
```

Если что-то пойдет не так, и контейнер с новой версией упадёт, процесс остановится, и мы увидим это. Далее мы можем сделать откат на старую версию. Таким образом мы не затронем всех пользователей.

Иногда процесс обновления может быть слишком быстрым, и приложения новых версий еще не в полной мере готовы принимать трафик. Мы можем добавить задержку между каждым обновлением с использованием опции `--update-delay`.

```
docker service update --update-delay 60s --image=nginx:alpine webserver
```

Таким образом, после обновления каждого экземпляра оркестратор будет ждать минимум 60 секунд, прежде чем начнёт обновлять следующий экземпляр.
