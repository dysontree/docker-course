---
layout: article
---
```
FROM node

COPY . ./

RUN yarn install
RUN yarn build

FROM nginx

COPY --from=0 dist /usr/share/nginx/html

CMD [ "nginx", "-g", "daemon off;" ]
```

Для этого нам нужно добавить специальную опцию `--from` в инструкцию `COPY` в секцию второго образа. Этой опцией мы сообщим, что файлы нужно копировать не с docker-хоста, а из стадии этой же сборки.

Эта опция `--from` может принимать числа в качестве параметра. Наши стадии идут под индексами, начинаясь с нуля. Поэтому `ноль` здесь указывает на самую первую сборку образа, которая ранее у нас называлась `builder`. Но сейчас мы можем обратиться к ней по номеру `0`, поскольку это номер стадии в этой многоэтапной сборке.

```
FROM node AS builder

COPY . ./

RUN yarn install
RUN yarn build

FROM nginx

COPY --from=builder dist /usr/share/nginx/html

CMD [ "nginx", "-g", "daemon off;" ]
```

Это будет работать, но все же человеку с таким не всегда удобно. Нам проще, когда мы знаем стадии по именам, например `builder`, `my-dashboard` и т.д. Вариант с названием тоже есть. Для этого есть директива `AS`, она указывается в инструкции `FROM`. С ее помощью мы можем назвать отдельную стадию нужным нам именем. Например, я назову первый этап `builder`.

Теперь в опции `---from` инструкции `COPY` мы можем ссылаться не на номер стадии, а на её имя, что очень удобно!

Но это ещё не все. При работе с multi-stage нам необязательно запускать весь цикл целиком. Мы можем прицелиться в отдельную стадию. Если мы хотим собрать определенную стадию, укажем ее в команде при помощи параметра `--target`, как ты видишь.

```
docker image build  --target builder -t my-dashboard .
```
