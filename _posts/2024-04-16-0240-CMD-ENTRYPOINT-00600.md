---
layout: article
---

Ок, но это еще не всё, что касается особенностей работы оболочки в Dockerfile. У нас есть инструкция `SHELL`, которой можно задать оболочку по умолчанию. Дефолтные значения у сборщика:

- ["/bin/sh", "-c"] для Linux
- ["cmd", "/S", "/C"] для Windows

Попробуем наш пример с переопределённой оболочкой:

```
FROM alpine  
RUN apk add bash
SHELL ["/bin/bash", "-c"]
ENTRYPOINT while true; do echo $RANDOM; sleep 1; done
```

```
docker image build --quiet -f  Dockerfile-5 -t test5 . && docker container run --rm test5
```

```
docker  container  top  9493  -x
```

Кроме того, что мы видим изменившуюся оболочку по умолчанию, у нас появится проблема с выходом по `ctrl + C`. Причина этого в том, что bash не получает `SIGINT` от терминала. Для работы комбинации выхода нам нужно использовать флаг запуска `-it`. Но по какой-то причине это работает с оболочкой по умолчанию без интерактивной опции.

Директиву `SHELL` можно использовать несколько раз внутри Dockerfile. Например, мы можем исполнить часть инструкций `RUN` с одной оболочкой, а оставшуюся часть с другой. Также есть возможность задать оболочку индивидуально для каждого `RUN`.

```
FROM alpine  
RUN apk add bash

SHELL ["/bin/bash", "-c"]
RUN echo "echo Iam $0"

SHELL ["/bin/sh", "-c"]
RUN echo "echo Iam $0"

RUN ["/bin/bash", "-c", "echo Iam $0"]
```

```
docker image build -f  Dockerfile-6 .
```

Что же, это всё о дополнительных настройках точки входа в контейнер. Увидимся!
