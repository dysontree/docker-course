---
layout: article
---

По умолчанию, если мы не настроили другого, Docker будет использовать хостового суперпользователя для запуска нагрузок. Мы можем проверить, как это работает. Я запущу простой контейнер с alpine, чтобы он спал 1 час.

```
docker  container  run  -d  alpine  sleep  1h
```

Теперь поищем этот процесс в дереве процессов хоста.

```
ps aux | grep sleep | grep -v grep
```

Как видишь, процесс исполняется под суперюзером. Может быть проблема в том, что я запускаю docker-контейнер, находясь залогиненным как root?

Я зайду на хост рядовым пользователем `max`, который только состоит в группе docker, других привилегий у него нет.

```
id
```

Сделаю то же самое:

```
docker run -d alpine sleep 1h
```

```
ps aux | grep sleep | grep -v grep
```

Теперь у нас два контейнера, и оба выполняются от root.

Мы видели выше, что юзера max UID = 1001. Запущу третий спящий контейнер под ним, указав параметр `--user=1001` с командой id. Я всё также сижу под юзером max без привилегий.

```
docker run -d --user 1001 alpine sleep 1h
```

Теперь с хоста мы видим, что пользователь внутри - это тот, кого на хосте мы знаем как `max`.

Базовая модель безопасности Doсker - `всё или ничего`. Это значит, что если у тебя есть доступ к демону, то ты станешь root в Docker. И это очень опасно, особенно если разрешены монтирования на хост.
