---
layout: article
---

Приложение `result` - это веб-сервер. И если он отвечает на http-запрос, значит приложение работоспособно. Мы можем настроить для него проверку работоспособности (`healthcheck`), чтобы быть уверенными, что оно не зависло. Мы уже добавляли такие проверки в compose-файл. 

Здесь мы делаем запрос утилитой `curl` внутри контейнера обращаясь на его `localhost`.  Запускать эту команду будем каждые 15 секунд. Таймаут устанавливаем в 5 секунд. Это значит, что мы даём 5 секунд на исполнение команды. Если через 5 секунд ответ не поступит, значит мы считаем, что произошёл сбой. 

Итак, этот healthcheck каждые 15 секунд запускает команду внутри контейнера, ей он обращается к самому себе и даёт веб-серверу 5 секунд для того, чтобы тот вернул какой-то ответ. Если ответа не произошло, он смотрит в опцию повторных попыток (`retries`). `retries` - это количество повторов, которое нужно сделать и получить плохой результат, прежде чем пометить контейнер как неисправный.

`start_period` это время, которое Docker дает контейнеру для старта, в тот момент, когда он запускается. Многие приложения стартуют не сразу - им нужно некоторое время для инициализации и внутренних проверок, прежде чем они встанут в рабочий режим. Поэтому мы хотим, чтобы эта проверка здоровья начала работать только через 10 секунд после запуска контейнера.

Как ты помнишь, в демо с compose мы использовали и другие проверки, например для баз данных у нас были написаны специальные скрипты. В этих скриптах мы обращались к базе по cli, и если она отвечала, считали, что с ней всё в порядке. В демо мы реализуем и эти возможности.

Напоследок, несколько дополнительных stack-команд.
